<div class="container">
  <div class="wrapper">
    <h2 class="float-left"><%= @team.name %></h2>
    <% if can? :manage, Team %>
    <%= link_to "Remove Team", team_path(@team.id), method: :delete, data:{ confirm: 'Are you sure?' }, class: 'btn btn-secondary float-right' %>
    <button type="button" class="btn btn-secondary float-right mr-2" data-toggle="modal" data-target="#edit_team_modal">Edit Team</button>
    <%= render partial: 'edit_team_modal'%>
  <% end %>  
  </div>
  <br>

  <div>
    <h3>Members </h3>    
    <table class="table table-hover" id="team_members_table">
      <thead>
        <th scope="row">Name</th>
        <th scope="row">Admin</th>
        <th scope="row">Action</th>
      </thead>
      <tbody>

        <% @team_memberships.each do |membership| %>
          <% if membership.team_id == @team.id && membership.is_approved %>
            <tr id="membership_<%= membership.id %>"> <span class="glyphicon glyphicon-user"></span> 
              <td><%= membership.user.name%></td>
              <% if membership.is_team_admin %>
                <td>Yes</td>
              <% else %>
                <td>No</td>
              <% end %>
              <td><%= link_to 'Remove', remove_member_team_path(@team.id, membership_id: membership.id), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-outline-danger btn-sm', remote: true %></td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
  <br><br>
  <% if can? :manage, Team %>
     <h2>Add member </h2>
      <%= form_tag add_membership_teams_path, method: 'get', remote: true do %>
        <div class="row">
          <div class="col-3">
            <%= select_tag "user_id", options_from_collection_for_select(@all_members, :id, :first_name), id: 'js_members_select', class: 'form-control' %>
            <%= hidden_field_tag(:team_id, @team.id) %>
            <%= hidden_field_tag(:is_approved, true) %>
          </div>
          <div class="col-2">
            <div class="form-group form-check">
              <div class="form-check-label">
                <%= check_box 'join_admin', 'joining_decision', {}, 1, 0 %>
                <%= label_tag(:join_admin, "Admin", class: 'form-check-label') %>
              </div>
            </div>
          </div>   
          <div class="col-2">
            <div class="form-group">
              <button type="submit" class="btn btn-secondary">Add member</button>
            </div>
          </div>
        </div>
      <% end %>
  <% end %>
</div>