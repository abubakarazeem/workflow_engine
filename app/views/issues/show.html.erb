
<div class="wrapper">
  <h2 class="float-left"><%= @issue.title %></h2>
  <% if can?([:destroy_watcher, :search_watcher_to_destroy], IssueWatcher) %>
    <button type="button" class="btn btn-secondary float-right" data-toggle="modal" data-target="#remove_watchers_modal">Remove Watcher</button>
    <%= render partial: 'issue_watchers/remove_watchers_form', locals: { issue: @issue } %>
  <% end %>  

  <% if can?([:create_watcher, :search_watcher_to_add], IssueWatcher) %>
    <button type="button" class="btn btn-secondary float-right mr-2" data-toggle="modal" data-target="#add_watchers_modal">Add Watcher</button>
    <%= render partial: 'issue_watchers/add_watchers_form', locals: { issue: @issue } %>
  <% end %>

  <div id="watch_button_div" class="float-right mr-2">
    <%= render partial: 'issue_watchers/watch_button', locals: { issue: @issue } %>
  </div>

  <% if can?(:update, @issue) %>
    <%= link_to 'Edit', edit_project_issue_path(@issue.project_id, @issue.id), class: 'btn btn-secondary float-right mr-2' %>
  <% end %>

  <% if can?(:history, @issue) %>
    <%= link_to 'History', history_issue_path(@issue), class: 'btn btn-secondary float-right mr-2' %>
  <% end %>
</div>
<br>
<table class="table">
  <tbody>
    <tr>
      <th scope="row">Title:</th>
      <td><%= @issue.title %></td>
    </tr>
    <tr>
      <th scope="row">Description:</th>
      <td><%= @issue.description %></td>
    </tr>
    <tr>
      <th scope="row">Start Date:</th>
      <td><%= @issue.start_date %></td>
    </tr>
    <tr>
      <th scope="row">Due Date:</th>
      <td><%= @issue.due_date %></td>
    </tr>
    <tr>
      <th scope="row">Progress:</th>
      <td><%= @issue.progress %></td>
    </tr>
    <tr>
      <th scope="row">Priority:</th>
      <td><%= get_priority(@issue.priority) %></td>
    </tr>
    <tr>
      <th scope="row">State:</th>
      <td><%= @issue.issue_state.try(:name) %></td>
    </tr>
    <tr>
      <th scope="row">Assignee:</th>
      <td><span class="glyphicon glyphicon-user"></span><%= @issue.assignee.try(:name) %></td>
    </tr>
    <tr>
      <th scope="row">Issue Type:</th>
      <td><%= @issue.issue_type.try(:name) %></td>
    </tr>
  </tbody>
</table>

<%= link_to 'Show all Documents', issue_documents_path(@issue),class: 'btn btn-primary' %>
<div class="page-header"><h3>Upload Document</h3></div>
<%= form_for [@issue, @document], html: { multipart: true } do |f| %>
  <% if @document.errors.any? %>
    <div id="error_explanation">
      <h2>
        <%= "#{pluralize(@document.errors.count, "error")} prohibited this document from being saved:" %>
      </h2>
      <ul>
        <% @document.errors.full_messages.each do |msg| %>
          <li>
            <%= msg %>
          </li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <div class="form-group upload_document_field">
    <%= f.file_field :document %>
  </div>
  <div class="form-group">
    <%= f.submit 'Upload Document', class: 'btn btn-secondary' %>
  </div>
<% end %>
